{"version":3,"file":"rage-connector.js","sources":["ng://rage-connector/lib/rage-connector.service.ts","ng://rage-connector/lib/rage-connector.component.ts","ng://rage-connector/lib/rage-connector.module.ts"],"sourcesContent":["import { Injectable, NgZone } from '@angular/core';\n\ndeclare const mp: {\n  trigger(eventName: string, ...args: any): void;\n};\ndeclare const window: any;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class RageConnectorService {\n\n  private events: {[key: string]: ((...args: any) => void)[]} = {};\n  private callbackEvents: {[key: string]: ((...args: any) => void)[]} = {};\n\n  constructor(private zone: NgZone) {\n    window.RageAngularEvent = this.rageEventHandler;\n  }\n\n  public rageEventHandler(eventName: string, ...args: any) {\n    this.zone.run(() => {\n      if (this.events[eventName]) {\n        for (const func of this.events[eventName]) {\n          func(...args);\n        }\n      }\n      if (this.callbackEvents[eventName]) {\n        const callbackFunctions = this.callbackEvents[eventName];\n        this.callbackEvents[eventName] = undefined;\n        for (const func of callbackFunctions) {\n          func(...args);\n        }\n      }\n    });\n  }\n\n  /**\n   * Adds an \"event listener\" for \"events\" from RAGE clientside.\n   * Don't forget to use lambda for callback or add bind(this),\n   * else \"this\" in the function will refer to rage-connector.service.ts instead.\n   * @param eventName Name of the event used in RAGE\n   * @param callback Any function\n   */\n  public listen(eventName: string, callback: (...args: any) => void) {\n    if (!this.events[eventName]) {\n      this.events[eventName] = [];\n    }\n    this.events[eventName].push(callback);\n  }\n\n  public call(eventName: string, ...args: any) {\n    if (typeof mp == \"undefined\") // testing without RAGE\n      return;\n    mp.trigger(eventName, ...args);\n  }\n\n  /**\n   * Calls an event and adds an \"event listener\" for a response from RAGE clientside.\n   * Don't forget to use lambda for callback or add bind(this),\n   * else \"this\" in the function will refer to rage-connector.service.ts instead.\n   * @param eventName Name of the event used in RAGE\n   * @param args Any arguments\n   * @param callback Any function\n   */\n  public callCallback(eventName: string, args: any[] | undefined, callback: (...args: any) => void) {\n    if (typeof mp == \"undefined\") // testing without RAGE\n      return;\n    if (!this.callbackEvents[eventName]) {\n      this.callbackEvents[eventName] = [];\n    }\n    this.callbackEvents[eventName].push(callback);\n    if (args)\n      mp.trigger(eventName, ...args);\n    else\n      mp.trigger(eventName);\n  }\n}\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'lib-rage-connector',\n  template: `\n    <p>\n      rage-connector works!\n    </p>\n  `,\n  styles: []\n})\nexport class RageConnectorComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { RageConnectorComponent } from './rage-connector.component';\n\n\n\n@NgModule({\n  declarations: [RageConnectorComponent],\n  imports: [\n  ],\n  exports: [RageConnectorComponent]\n})\nexport class RageConnectorModule { }\n"],"names":[],"mappings":";;;;;;AAAA,MAUa,oBAAoB;;;;IAK/B,YAAoB,IAAY;QAAZ,SAAI,GAAJ,IAAI,CAAQ;QAHxB,WAAM,GAAgD,EAAE,CAAC;QACzD,mBAAc,GAAgD,EAAE,CAAC;QAGvE,MAAM,CAAC,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,CAAC;KACjD;;;;;;IAEM,gBAAgB,CAAC,SAAiB,EAAE,GAAG,IAAS;QACrD,IAAI,CAAC,IAAI,CAAC,GAAG;;;QAAC;YACZ,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE;gBAC1B,KAAK,MAAM,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE;oBACzC,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC;iBACf;aACF;YACD,IAAI,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE;;sBAC5B,iBAAiB,GAAG,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC;gBACxD,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,SAAS,CAAC;gBAC3C,KAAK,MAAM,IAAI,IAAI,iBAAiB,EAAE;oBACpC,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC;iBACf;aACF;SACF,EAAC,CAAC;KACJ;;;;;;;;;IASM,MAAM,CAAC,SAAiB,EAAE,QAAgC;QAC/D,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE;YAC3B,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC;SAC7B;QACD,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KACvC;;;;;;IAEM,IAAI,CAAC,SAAiB,EAAE,GAAG,IAAS;QACzC,IAAI,OAAO,EAAE,IAAI,WAAW;YAC1B,OAAO;QACT,EAAE,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,IAAI,CAAC,CAAC;KAChC;;;;;;;;;;IAUM,YAAY,CAAC,SAAiB,EAAE,IAAuB,EAAE,QAAgC;QAC9F,IAAI,OAAO,EAAE,IAAI,WAAW;YAC1B,OAAO;QACT,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE;YACnC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC;SACrC;QACD,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC9C,IAAI,IAAI;YACN,EAAE,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,IAAI,CAAC,CAAC;;YAE/B,EAAE,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;KACzB;;;YApEF,UAAU,SAAC;gBACV,UAAU,EAAE,MAAM;aACnB;;;;YAToB,MAAM;;;;;;;;IAYzB,sCAAiE;;;;;IACjE,8CAAyE;;;;;IAE7D,oCAAoB;;;;;;;ACflC,MAWa,sBAAsB;IAEjC,iBAAiB;;;;IAEjB,QAAQ;KACP;;;YAdF,SAAS,SAAC;gBACT,QAAQ,EAAE,oBAAoB;gBAC9B,QAAQ,EAAE;;;;GAIT;aAEF;;;;;;;;;ACVD,MAWa,mBAAmB;;;YAN/B,QAAQ,SAAC;gBACR,YAAY,EAAE,CAAC,sBAAsB,CAAC;gBACtC,OAAO,EAAE,EACR;gBACD,OAAO,EAAE,CAAC,sBAAsB,CAAC;aAClC;;;;;;;;;;;;;;;"}