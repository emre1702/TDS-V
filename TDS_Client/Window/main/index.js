"use strict";var e=$("#bloodscreen"),o=$("#kill_messages_box"),n=9,t=$("#orders"),a,r=$("#audio_hit"),c=[r,r.clone(!0),r.clone(!0),r.clone(!0),r.clone(!0),r.clone(!0),r.clone(!0),r.clone(!0),r.clone(!0),r.clone(!0)],i=0,l=c.length,s=$("#audio_bombTick"),u=[s,s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0),s.clone(!0)],p=0,g=u.length,h,d=.5,m=!1,f=[];function playSound(n){$("#audio_"+n).trigger("play").prop("volume",d)}function playHitsound(){c[i++].trigger("play").prop("volume",d),i==l&&(i=0)}function b(){u[p++].trigger("play").prop("volume",d),p==g&&(p=0)}function playKillstreakSound(n){m?f.push(n):($("#audio_"+soundname).trigger("play").prop("volume",d),m=!0)}function onKillstreakSoundEnded(){var n;(m=!1,0!=f.length)&&playKillstreakSound(f.shift())}function startBombTickSound(n,e){b();var o,t=3e3-2950*(e/n);null!=h&&clearTimeout(h),h=setTimeout(function(){return startBombTickSound(n,e+t)},t)}function stopBombTickSound(){null!=h&&(clearTimeout(h),h=null)}function showBloodscreen(){if(a){clearTimeout(a);var n=e.get()[0];n.style.animation="none",n.offsetHeight,n.style.animation="BloodscreenAnim 2.5s"}else e.css({display:"block",animation:"BloodscreenAnim 2.5s"});a=setTimeout(function(){e.css("display","none"),a=null},2500)}function v(n){var e='<span style="color: white;">',o=n;return-1!==n.indexOf("~")&&(o=o.replace(/~r~/g,'</span><span style="color: rgb(222, 50, 50);">').replace(/~b~/g,'</span><span style="color: rgb(92, 180, 227);">').replace(/~g~/g,'</span><span style="color: rgb(113, 202, 113);">').replace(/~y~/g,'</span><span style="color: rgb(238, 198, 80);">').replace(/~o~/g,'</span><span style="color: rgb(253, 132, 85);">').replace(/~s~/g,'</span><span style="color: rgb(220, 220, 220);">').replace(/~w~/g,'</span><span style="color: white;">').replace(/~dr~/g,'</span><span style="color: rgb( 169, 25, 25 );">').replace(/~n~/g,"<br>")),e+o+"</span>"}function y(n){n.remove()}function addKillMessage(n){var e=$("<text>"+v(n)+"<br></text>");o.append(e),e.delay(11e3).fadeOut(4e3,e.remove)}function w(n){n?t.show(1e3):t.hide(1e3)}var _={amountentries:[0,0],maxentries:40,active:!0,inputshowing:!1,maininput:$("#main-input"),bodies:[$("#normal-chat-body"),$("#dirty-chat-body")],chatends:["$normal$","$dirty$"],chosentab:null,chosenchatbody:0,myname:null,globalsaykeycode:"Z"===String.fromCharCode(90)?90:Y,playernames:[],autocompleteon:!1},x=[[/#r#/g,"rgb(222, 50, 50)"],[/#b#/g,"rgb(92, 180, 227)"],[/#g#/g,"rgb(113, 202, 113)"],[/#y#/g,"rgb(238, 198, 80)"],[/#p#/g,"rgb(131, 101, 224)"],[/#q#/g,"rgb(226, 79, 128)"],[/#o#/g,"rgb(253, 132, 85)"],[/#s#/g,"rgb(220, 220, 220)"],[/#w#/g,"white"],[/#dr#/g,"rgb(169, 25, 25)"]];function k(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;(n=null===n?S():n).finish().animate({scrollTop:n.prop("scrollHeight")},"slow")}function enableChatInput(n){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";!_.active&&n||n!==_.inputshowing&&(mp.invoke("focus",n),n?(_.maininput.fadeIn(),_.maininput.val(e),setTimeout(function(){_.maininput.focus()},100)):(_.maininput.hide(),_.maininput.val("")),_.inputshowing=n,mp.trigger("ChatInputToggled_Browser",n))}var chatAPI={};function O(n){for(var e=n.indexOf("!{");-1!=e;){var o=n.indexOf("}",e+2);if(-1==o)break;var t=n.substring(e,o+1),a=t.substring(2,t.length-1).split("|"),r=void 0;1==a.length?r=a[0]:a.length<3?r="rgb(".concat(0 in a?a[0]:0,", ").concat(1 in a?a[1]:0,", 0)"):3==a.length?r="rgb(".concat(a[0],", ").concat(a[1],", ").concat(a[2],")"):4==a.length&&(r="rgba(".concat(a[0],", ").concat(a[1],", ").concat(a[2],", ").concat(a[3],")"));var c="</span><span style='color: "+r+";'>";e=(n=n.replace(t,c)).indexOf("!{",e+c.length)}return n}function C(n,e){var o="";e&&(o='<span style="background-color: rgba(255,178,102,0.6);">'),o+='<span style="color: white;">';var t=n;if(-1!==n.indexOf("#")){for(var a=0;a<x.length;++a)t=t.replace(x[a][0],"</span><span style='color: "+x[a][1]+";'>");t=t.replace(/#n#/g,"<br>")}return t=O(t),e&&(t+="</span>"),o+t+"</span>"}function T(n){if(null===_.myname)return!1;var e=n.indexOf("@");if(-1===e)return!1;var o=n.indexOf(":",e+1),t;return-1!==o&&n.substring(e+1,o)===_.myname}function B(n,e,o){e.append(n),++_.amountentries[o]>=_.maxentries&&(--_.amountentries[o],e.find("text:first").remove()),k(e)}function A(n){for(var e=T(n),o=0;o<_.chatends.length;++o)if(n.endsWith(_.chatends[o])){n=n.slice(0,-_.chatends[o].length);var t=S(o),a=C(n,e),r;return void B($("<text>"+a+"</text>"),t,o)}for(var c=C(n,e),i=0;i<_.bodies.length;++i){var l=S(i),s;B($("<text>"+c+"</text>"),l,i)}}function S(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1,e=-1===n?_.chosenchatbody:n;return _.bodies[e]}function loadUserName(n){_.myname=n,_.playernames.push(n)}function loadNamesForChat(n){_.playernames=JSON.parse(n)}function addNameForChat(n){_.playernames.push(n)}function removeNameForChat(n){var e=_.playernames.indexOf(n);-1!=e&&_.playernames.splice(e,1)}function I(n){return void 0===n||null==n||n.replace(/\s/g,"").length<1}chatAPI.push=A,chatAPI.clear=function(){S().html("")},chatAPI.activate=function(n){_.active=n},chatAPI.show=function(n){n?(S().show(),$("#chat_choice").show()):(S().hide(),$("#chat_choice").hide()),_.active=n},$(document).ready(function(){addAutocomplete(_.maininput,_.playernames,function(){return!(_.autocompleteon=!0)},function(){setTimeout(function(){_.autocompleteon=!1},500)}),$("body").keydown(function(n){if(13===n.which&&_.inputshowing&&!_.autocompleteon){n.preventDefault();var e=_.maininput.val();I(e)?mp.trigger("CloseChat_Browser"):"/"===(e=e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"'))[0]?0<(e=e.substr(1)).length&&mp.trigger("CommandUsed_Browser",e):mp.trigger("ChatUsed_Browser",e,1==_.chosenchatbody)}}),_.chosentab=$("#chat_choice div[data-chatID=0]"),_.chosentab.css("background","#04074e"),$("#chat_choice div").click(function(){_.chosenchatbody!==$(this).attr("data-chatID")&&(_.chosentab.css("background","#A9A9A9"),_.bodies[_.chosenchatbody].hide(400),_.chosentab=$(this),_.chosentab.css("background","#04074e"),_.chosenchatbody=_.chosentab.attr("data-chatID"),_.bodies[_.chosenchatbody].show(400))}),mp.trigger("ChatLoaded_Browser")});var D=$("#round_end_reason"),R=$("#round_end_reason_container"),H={},J,N=new SimpleStarRating($("#map_rating_stars")[0],function(n){J in H&&H[J]===n||(H[J]=n,mp.trigger("SendMapRating_Browser",J,n),N.disable())});function showRoundEndReason(n,e){D.html(n),R.css("display","table"),(J=e)in H?N.setCurrentRating(H[e]):N.setCurrentRating(0),N.enable()}function hideRoundEndReason(){R.hide()}function loadMyMapRatings(n){H=JSON.parse(n)}