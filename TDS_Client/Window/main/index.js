"use strict";var n=$("#bloodscreen"),e,t=$("#kill_messages_box"),o=9,a=$("#orders"),r,c=$("#audio_hit"),i=[c,c.clone(!0),c.clone(!0),c.clone(!0),c.clone(!0),c.clone(!0),c.clone(!0),c.clone(!0),c.clone(!0),c.clone(!0)],l=0,s=i.length,u=$("#audio_bombTick"),g=[u,u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0),u.clone(!0)],p=0,h=g.length,d,m=.05,f=!1,b=[];function playSound(n){$("#audio_"+n).trigger("play").prop("volume",m)}function playHitsound(){i[l++].trigger("play").prop("volume",m),l==s&&(l=0)}function y(){g[p++].trigger("play").prop("volume",m),p==h&&(p=0)}function playKillstreakSound(n){f?b.push(n):($("#audio_"+soundname).trigger("play").prop("volume",m),f=!0)}function onKillstreakSoundEnded(){var n;(f=!1,0!=b.length)&&playKillstreakSound(b.shift())}function startBombTickSound(n,e){y();var t,o=3e3-2950*(e/n);null!=d&&clearTimeout(d),d=setTimeout(function(){return startBombTickSound(n,e+o)},o)}function stopBombTickSound(){null!=d&&(clearTimeout(d),d=null)}function showBloodscreen(){r?(clearTimeout(r),e.style.animation="none",e.offsetHeight,e.style.animation="BloodscreenAnim 2.5s"):n.css({animation:"BloodscreenAnim 2.5s","animation-fill-mode":"forwards"}),r=setTimeout(function(){r=null,n.css({animation:""})},2500)}function v(n){var e='<span style="color: white;">',t=n;return-1!==n.indexOf("~")&&(t=t.replace(/~r~/g,'</span><span style="color: rgb(222, 50, 50);">').replace(/~b~/g,'</span><span style="color: rgb(92, 180, 227);">').replace(/~g~/g,'</span><span style="color: rgb(113, 202, 113);">').replace(/~y~/g,'</span><span style="color: rgb(238, 198, 80);">').replace(/~o~/g,'</span><span style="color: rgb(253, 132, 85);">').replace(/~s~/g,'</span><span style="color: rgb(220, 220, 220);">').replace(/~w~/g,'</span><span style="color: white;">').replace(/~dr~/g,'</span><span style="color: rgb( 169, 25, 25 );">').replace(/~n~/g,"<br>")),e+t+"</span>"}function w(n){n.remove()}function addKillMessage(n){var e=$("<text>"+v(n)+"<br></text>");t.append(e),e.delay(11e3).fadeOut(4e3,e.remove)}function _(n){n?a.show(1e3):a.hide(1e3)}$(document).ready(function(){e=n.get()[0]});var x={amountentries:[0,0],maxentries:40,active:!0,inputshowing:!1,maininput:$("#main-input"),bodies:[$("#normal-chat-body"),$("#dirty-chat-body")],chatends:["$normal$","$dirty$"],chosentab:null,chosenchatbody:0,myname:null,globalsaykeycode:"Z"===String.fromCharCode(90)?90:Y,playernames:[],autocompleteon:!1},O=[[/#r#/g,"rgb(222, 50, 50)"],[/#b#/g,"rgb(92, 180, 227)"],[/#g#/g,"rgb(113, 202, 113)"],[/#y#/g,"rgb(238, 198, 80)"],[/#p#/g,"rgb(131, 101, 224)"],[/#q#/g,"rgb(226, 79, 128)"],[/#o#/g,"rgb(253, 132, 85)"],[/#s#/g,"rgb(220, 220, 220)"],[/#w#/g,"white"],[/#dr#/g,"rgb(169, 25, 25)"]];function k(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;(n=null===n?I():n).finish().animate({scrollTop:n.prop("scrollHeight")},"slow")}function enableChatInput(n){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";!x.active&&n||n!==x.inputshowing&&(mp.invoke("focus",n),n?(x.maininput.fadeIn(),x.maininput.val(e),setTimeout(function(){x.maininput.focus()},100)):(x.maininput.hide(),x.maininput.val("")),x.inputshowing=n,mp.trigger("ChatInputToggled_Browser",n))}var chatAPI={};function C(n){for(var e=n.indexOf("!{");-1!=e;){var t=n.indexOf("}",e+2);if(-1==t)break;var o=n.substring(e,t+1),a=o.substring(2,o.length-1).split("|"),r=void 0;1==a.length?r=a[0]:a.length<3?r="rgb(".concat(0 in a?a[0]:0,", ").concat(1 in a?a[1]:0,", 0)"):3==a.length?r="rgb(".concat(a[0],", ").concat(a[1],", ").concat(a[2],")"):4==a.length&&(r="rgba(".concat(a[0],", ").concat(a[1],", ").concat(a[2],", ").concat(a[3],")"));var c="</span><span style='color: "+r+";'>";e=(n=n.replace(o,c)).indexOf("!{",e+c.length)}return n}function T(n,e){var t="";e&&(t='<span style="background-color: rgba(255,178,102,0.6);">'),t+='<span style="color: white;">';var o=n;if(-1!==n.indexOf("#")){for(var a=0;a<O.length;++a)o=o.replace(O[a][0],"</span><span style='color: "+O[a][1]+";'>");o=o.replace(/#n#/g,"<br>")}return o=C(o),e&&(o+="</span>"),t+o+"</span>"}function B(n){if(null===x.myname)return!1;var e=n.indexOf("@");if(-1===e)return!1;var t=n.indexOf(":",e+1),o;return-1!==t&&n.substring(e+1,t)===x.myname}function S(n,e,t){e.append(n),++x.amountentries[t]>=x.maxentries&&(--x.amountentries[t],e.find("text:first").remove()),k(e)}function A(n){for(var e=B(n),t=0;t<x.chatends.length;++t)if(n.endsWith(x.chatends[t])){n=n.slice(0,-x.chatends[t].length);var o=I(t),a=T(n,e),r;return void S($("<text>"+a+"</text>"),o,t)}for(var c=T(n,e),i=0;i<x.bodies.length;++i){var l=I(i),s;S($("<text>"+c+"</text>"),l,i)}}function I(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1,e=-1===n?x.chosenchatbody:n;return x.bodies[e]}function loadUserName(n){x.myname=n,x.playernames.push(n)}function loadNamesForChat(n){x.playernames=JSON.parse(n)}function addNameForChat(n){x.playernames.push(n)}function removeNameForChat(n){var e=x.playernames.indexOf(n);-1!=e&&x.playernames.splice(e,1)}function D(n){return void 0===n||null==n||n.replace(/\s/g,"").length<1}chatAPI.push=A,chatAPI.clear=function(){I().html("")},chatAPI.activate=function(n){x.active=n},chatAPI.show=function(n){n?(I().show(),$("#chat_choice").show()):(I().hide(),$("#chat_choice").hide()),x.active=n},$(document).ready(function(){addAutocomplete(x.maininput,x.playernames,function(){return!(x.autocompleteon=!0)},function(){setTimeout(function(){x.autocompleteon=!1},500)}),$("body").keydown(function(n){if(13===n.which&&x.inputshowing&&!x.autocompleteon){n.preventDefault();var e=x.maininput.val();D(e)?mp.trigger("CloseChat_Browser"):"/"===(e=e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"'))[0]?0<(e=e.substr(1)).length&&("test"==e&&A(JSON.stringify(x.playernames)),mp.trigger("CommandUsed_Browser",e)):mp.trigger("ChatUsed_Browser",e,1==x.chosenchatbody)}}),x.chosentab=$("#chat_choice div[data-chatID=0]"),x.chosentab.css("background","#04074e"),$("#chat_choice div").click(function(){x.chosenchatbody!==$(this).attr("data-chatID")&&(x.chosentab.css("background","#A9A9A9"),x.bodies[x.chosenchatbody].hide(400),x.chosentab=$(this),x.chosentab.css("background","#04074e"),x.chosenchatbody=x.chosentab.attr("data-chatID"),x.bodies[x.chosenchatbody].show(400))}),mp.trigger("ChatLoaded_Browser")});var R=$("#round_end_reason"),J=$("#round_end_reason_container"),N={},H,U=new SimpleStarRating($("#map_rating_stars")[0],function(n){H in N&&N[H]===n||(N[H]=n,mp.trigger("SendMapRating_Browser",H,n),U.disable())});function showRoundEndReason(n,e){R.html(n),J.css("display","table"),(H=e)in N?U.setCurrentRating(N[e]):U.setCurrentRating(0),U.enable()}function hideRoundEndReason(){J.hide()}function loadMyMapRatings(n){N=JSON.parse(n)}