<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>TDS voice</title>
        <script src="../dist/RTCMultiConnection.min.js"></script>
        <script src="../dev/getHTMLMediaElement.js"></script>
        <script src="/socket.io/socket.io.js"></script>
    </head>
    <body>
        <div id="audios_container"></div>
    </body>
    <script>
        	let connection = new RTCMultiConnection();

			connection.socketURL = 'https://localhost.com:8546/';

			connection.socketMessageEvent = 'audio-conference-demo';

			connection.session = {
			    audio: true,
			    video: false
			};

			connection.mediaConstraints = {
			    audio: true,
			    video: false
			};

			connection.sdpConstraints.mandatory = {
			    OfferToReceiveAudio: true,
			    OfferToReceiveVideo: false
			};

			connection.audiosContainer = document.getElementById( "audios_container" );

			connection.onstream = function ( event ) {
			    var width = parseInt( connection.audiosContainer.clientWidth / 2 ) - 20;
			    var mediaElement = getHTMLMediaElement( event.mediaElement, {
			        title: event.userid,
			        buttons: ['full-screen'],
			        width: width,
			        showOnMouseEnter: false
			    } );

			    connection.audiosContainer.appendChild( mediaElement );

			    mediaElement.media.play();
			    mediaElement.media.volume = 1.0;

			    mediaElement.id = event.streamid;
			};

			connection.onstreamended = function ( event ) {
			    var mediaElement = document.getElementById( event.streamid );
			    if ( mediaElement ) {
			        mediaElement.parentNode.removeChild( mediaElement );
			    }
			};
			( function () {
			    connection.openOrJoin( "1", function ( isRoomExist, roomid ) {
			        if ( !isRoomExist ) {
			            //showRoomURL( roomid );
			        }
			    } );
			} )();
		</script>
</html>