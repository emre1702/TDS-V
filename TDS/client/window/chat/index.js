"use strict";var t=[0,0],n=40,r=!0,e=!1,a=$("#main-input"),i=[$("#normal-chat-body"),$("#dirty-chat-body")],o=["$normal$","$dirty$"],c=void 0,h=0,l=null,g="Z"===String.fromCharCode(90)?90:Y,s=[[/#r#/g,"rgb(222, 50, 50)"],[/#b#/g,"rgb(92, 180, 227)"],[/#g#/g,"rgb(113, 202, 113)"],[/#y#/g,"rgb(238, 198, 80)"],[/#p#/g,"rgb(131, 101, 224)"],[/#q#/g,"rgb(226, 79, 128)"],[/#o#/g,"rgb(253, 132, 85)"],[/#s#/g,"rgb(220, 220, 220)"],[/#w#/g,"white"],[/#dr#/g,"rgb(169, 25, 25)"]];function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(t=null===t?m():t).animate({scrollTop:t.prop("scrollHeight")},"slow")}function f(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!r&&t||t!==e&&(mp.invoke("focus",t),t?(a.fadeIn(),a.val(n),setTimeout(function(){a.focus()},100)):(a.hide(),a.val("")),e=t,mp.trigger("onChatInputToggle",t))}var chatAPI={};chatAPI.push=b,chatAPI.clear=function(){m().html("")},chatAPI.activate=function(t){f(t),r=t},chatAPI.show=function(t){t?(m().show(),$("#chat_choice").show()):(m().hide(),$("#chat_choice").hide()),!t&&e&&f(!1),r=t};function d(t,n){var r="";n&&(r='<span style="background-color: rgba(255,178,102,0.5);">'),r+='<span style="color: white;">';var e=t;if(-1!==t.indexOf("#")){for(var a=0;a<s.length;++a)e=e.replace(s[a][0],"</span><span style='color: "+s[a][1]+";'>");e=e.replace(/#n#/g,"<br>")}return n&&(e+="</span>"),r+e+"</span>"}function v(t){if(null===l)return!1;var n=t.indexOf("@");if(-1===n)return!1;var r=t.indexOf(":",n+1);if(-1===r)return!1;var e;return t.substring(n+1,r)===l}function p(r,e,a){e.append(r),++t[a]>=n&&(--t[a],e.find("text:first").remove()),u(e)}function b(t){for(var n=v(t),r=0;r<o.length;++r)if(t.endsWith(o[r])){t=t.slice(0,-o[r].length);var e=m(r),a=d(t,n),c;return void p($("<text>"+a+"</text>"),e,r)}for(var h=d(t,n),l=0;l<i.length;++l){var g=m(l),s;p($("<text>"+h+"</text>"),g,l)}}function m(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n;return i[-1===t?h:t]}function loadUserName(t){l=t}$(document).ready(function(){$("body").keydown(function(t){if(84===t.which&&!e&&r)t.preventDefault(),f(!0);else if(t.which===g&&!e&&r)t.preventDefault(),f(!0,"/globalsay ");else if(13===t.which&&e){t.preventDefault();var n=a.val();n&&("/"===n[0]?(n=n.substr(1)).length>0&&mp.invoke("command",n):mp.invoke("chatMessage",n+o[h])),f(!1)}}),(c=$("#chat_choice div[data-chatID=0]")).css("background","#04074e"),$("#chat_choice div").click(function(){h!==$(this).attr("data-chatID")&&(c.css("background","#A9A9A9"),i[h].hide(400),(c=$(this)).css("background","#04074e"),h=c.attr("data-chatID"),i[h].show(400))}),mp.trigger("onChatLoad")});