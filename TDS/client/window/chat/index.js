"use strict";var e=0,n=40,t=!0,r=!1,o=null,i=null,a=[[/~r~/g,"rgb(222, 50, 50)"],[/~b~/g,"rgb(92, 180, 227)"],[/~g~/g,"rgb(113, 202, 113)"],[/~y~/g,"rgb(238, 198, 80)"],[/~p~/g,"rgb(131, 101, 224)"],[/~q~/g,"rgb(226, 79, 128)"],[/~o~/g,"rgb(253, 132, 85)"],[/~s~/g,"rgb(220, 220, 220)"],[/~w~/g,"white"],[/~dr~/g,"rgb(169, 25, 25)"]];function g(){s().animate({scrollTop:s().prop("scrollHeight")},"slow")}function l(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!t&&e||e!==r&&(mp.invoke("focus",e),e?(o.fadeIn(),o.val(n),setTimeout(function(){o.focus()},100)):(o.hide(),o.val("")),r=e,mp.trigger("onChatInputToggle",e))}var chatAPI={};chatAPI.push=u,chatAPI.clear=function(){s().html("")},chatAPI.activate=function(e){l(e)},chatAPI.show=function(e){e?s().show():s().hide(),t=e};function c(e){var n='<span style="color: white;">',t=e;if(-1!==e.indexOf("~")){for(var r=0;r<a.length;++r)t=t.replace(a[r][0],"</span><span style='color: "+a[r][1]+";'>");t=t.replace(/~n~/g,"<br>")}return n+t+"</span>"}function u(t){var r=$("<text>"+c(t)+"<br></text>");s().append(r),++e>=n&&(--e,i.find("text:first").remove()),g()}function s(){return null===i&&(i=$("#chat-body")),i}$(document).ready(function(){o=$("#main-input"),$("body").keydown(function(e){if(84===e.which&&!r&&t)e.preventDefault(),l(!0);else if(90===e.which&&!r&&t)e.preventDefault(),l(!0,"/globalsay ");else if(13===e.which&&r){e.preventDefault();var n=o.val();n&&("/"===n[0]?(n=n.substr(1)).length>0&&mp.invoke("command",n):mp.invoke("chatMessage",n)),l(!1)}}),mp.trigger("onChatLoad")});