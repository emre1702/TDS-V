"use strict";var t=$("#mapcreatormenu"),e=[$("#general_tabcontent"),$("#description_tabcontent"),$("#team_spawns_tabcontent"),$("#map_limit_tabcontent"),$("#map_points_tabcontent"),$("#bomb_places_tabcontent"),$("#last_tabcontent")],a=[$("#team_spawns_table"),$("#map_limit_table"),void 0,$("#bomb_places_table")],r=$("#team_number_teamspawns"),n=null,i=0,s=null,l=void 0,o=!0;setElementDraggable(t[0]);function openMapCreatorMenu(t){for(var a=0;a<e.length;++a)e[a].removeClass("active").hide();e[t].addClass("active").show(),null!==n&&(n.removeAttr("bgcolor"),n=null)}openMapCreatorMenu(0);function p(){null!==n&&n.removeAttr("bgcolor"),n=null===n||n[0]!==$(this)[0]?$(this).attr("bgcolor","#04074eC7"):null}function addCurrentPosition(t){(0!==t||r.val())&&(i=t,mp.trigger("requestCurrentPositionForMapCreator"))}function gotoPosition(t){if(2===t||null!==n){var e=void 0,a=void 0,r=void 0,i="",s=void 0;switch(t){case 0:e=(s=n.find("td")).eq(1).text(),a=s.eq(2).text(),r=s.eq(3).text(),i=s.eq(4).text();break;case 1:case 3:e=(s=n.find("td")).eq(0).text(),a=s.eq(1).text(),r=s.eq(2).text();break;case 2:e=$("#map_center_x").text().substr(3),a=$("#map_center_y").text().substr(3),r=$("#map_center_z").text().substr(3)}mp.trigger("gotoPositionByMapCreator",parseFloat(e),parseFloat(a),parseFloat(r),parseFloat(i))}}function removePosition(){null!==n&&(n.remove(),c())}function loadPositionFromClient(t,e,n,s){var l=void 0;switch(i){case 0:(l=$("<tr><td>"+r.val()+"</td><td>"+t+"</td><td>"+e+"</td><td>+"+n+"</td><td>"+s+"</td></tr>")).click(p),a[i].append(l);break;case 1:case 3:(l=$("<tr><td>"+t+"</td><td>"+e+"</td><td>+"+n+"</td></tr>")).click(p),a[i].append(l);break;case 2:$("#map_center_x").text("X: "+t),$("#map_center_y").text("Y: "+e),$("#map_center_z").text("Z: "+n)}c()}function loadLanguage(t){l=JSON.parse(t),$("[data-lang]").each(function(){$(this).html(l[$(this).attr("data-lang")])}),$("[data-lang-placeholder]").each(function(){$(this).attr("placeholder",l[$(this).attr("data-lang-placeholder")])})}function sendMap(){var t={Name:$("#map_name_input").val(),Type:void 0!==$("#normal_radio_switch").attr("checked")?"normal":"bomb",Descriptions:{English:$("#english_description").attr("placeholder"),German:$("#german_description").attr("placeholder")},MinPlayers:parseInt($("#min_players").val()),MaxPlayers:parseInt($("#max_players").val()),MapSpawns:[],MapLimitPositions:[],MapCenter:{},BombPlaces:[]},e=$("#english_description").val();""!==e&&(t.Descriptions.English=e);var a=$("#german_description").val();""!==a&&(t.Descriptions.German=a),$("#team_spawns_table tr:not(:first-child)").each(function(){var e=$(this).find("td"),a=parseFloat(e.eq(0).text()),r=parseFloat(e.eq(1).text()),n=parseFloat(e.eq(2).text()),i=parseFloat(e.eq(3).text()),s=parseFloat(e.eq(4).text());t.MapSpawns.push({Team:a,X:r,Y:n,Z:i,Rot:s})}),$("#map_limit_table tr:not(:first-child)").each(function(){var e=$(this).find("td"),a=parseFloat(e.eq(0).text()),r=parseFloat(e.eq(1).text()),n=parseFloat(e.eq(2).text());t.MapLimitPositions.push({X:a,Y:r,Z:n})}),t.MapCenter.X=parseFloat($("#map_center_x").text().substr(3)),t.MapCenter.X=isNaN(t.MapCenter.X)?-9999:t.MapCenter.X,t.MapCenter.Y=parseFloat($("#map_center_y").text().substr(3)),t.MapCenter.Y=isNaN(t.MapCenter.Y)?-9999:t.MapCenter.Y,t.MapCenter.Z=parseFloat($("#map_center_z").text().substr(3)),t.MapCenter.Z=isNaN(t.MapCenter.Z)?-9999:t.MapCenter.Z,"bomb"===t.Type&&$("#bomb_places_table tr:not(:first-child)").each(function(){var e=$(this).find("td"),a=parseFloat(e.eq(0).text()),r=parseFloat(e.eq(1).text()),n=parseFloat(e.eq(2).text());t.BombPlaces.push({X:a,Y:r,Z:n})}),mp.trigger("sendMapFromCreator",JSON.stringify(t))}function c(){o||($("#send_map_button").attr("disabled",""),o=!0)}function m(){var t;if($("#map_name_input").val().length<6)return showDialog(l.map_name_atleast.replace("{1}","6")),!1;var e=parseInt($("#min_players").val());if(isNaN(e)||e<0||e>99)return showDialog(l.map_min_players_min_max.replace("{1}","0").replace("{2}","99")),!1;var a=parseInt($("#max_players").val());if(isNaN(a)||a<2||a>999)return showDialog(l.map_max_players_min_max.replace("{1}","2").replace("{2}","999")),!1;var r;if($("#team_spawns_table tr:not(:first-child)").length<4)return showDialog(l.map_team_spawns_min_per_team.replace("{1}","4")),!1;var n=$("#map_limit_table tr:not(:first-child)");if(0!==n.length&&(n.length<3||n.length>20))return showDialog(l.map_limit_min_max.replace("{1}","3").replace("{2}",20)),!1;if(void 0!==$("#bomb_radio_switch").attr("checked")){var i;if(0===$("#bomb_places_table tr:not(:first-child)").length)return showDialog(l.bomb_places_min.replace("{1}",1)),!1}return o=!1,$("#send_map_button").removeAttr("disabled"),!0}function checkMapName(){mp.trigger("checkMapName",$("#map_name_input").val())}function loadResultOfMapNameCheck(t){t?(alert(l.map_name_already_used),showDialog(l.map_name_already_used)):m()}function toggleBombContents(t){t?$(".bomb_content").show():$(".bomb_content").hide()}$(document).keyup(function(t){if(46===t.which){if(null===n)return;n.remove(),n=null}});