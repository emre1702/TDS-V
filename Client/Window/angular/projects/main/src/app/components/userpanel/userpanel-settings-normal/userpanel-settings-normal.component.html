<div id="container">
    <div id="settings-expansion-panel-container">
        <mat-accordion multi="false">
            <mat-expansion-panel *ngFor="let panel of settingPanel">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        {{ panel.title | language: settings.Lang }}
                    </mat-panel-title>
                </mat-expansion-panel-header>
                <ng-container *ngFor="let setting of panel.rows" [ngSwitch]="setting.type">

                    <ng-container *ngSwitchCase="userpanelSettingType.string">
                        <div class="setting-row">
                            <mat-form-field color="accent">
                                <input matInput [formControl]="setting.formControl"
                                    (blur)="changeDetector.detectChanges()"
                                    [placeholder]="userpanelSettingKey[setting.dataSettingIndex] | language: settings.Lang"
                                    [matTooltipDisabled]="!setting.tooltipLangKey"
                                    [matTooltip]="setting.tooltipLangKey | language: settings.Lang"
                                    (change)="setting.onValueChanged && setting.onValueChanged(setting.dataSettingIndex)"/>
                            </mat-form-field>
                        </div>
                    </ng-container>

                    <ng-container *ngSwitchCase="userpanelSettingType.number">
                        <div class="setting-row">
                            <mat-form-field color="accent">
                                <input matInput type="number" [formControl]="setting.formControl"
                                    (blur)="changeDetector.detectChanges()"
                                    [placeholder]="userpanelSettingKey[setting.dataSettingIndex] | language: settings.Lang"
                                    [matTooltipDisabled]="!setting.tooltipLangKey"
                                    [matTooltip]="setting.tooltipLangKey | language: settings.Lang"
                                    (change)="setting.onValueChanged && setting.onValueChanged(setting.dataSettingIndex)" />
                            </mat-form-field>
                        </div>
                    </ng-container>

                    <ng-container *ngSwitchCase="userpanelSettingType.numberSlider">
                        <div class="setting-row">
                            <span>{{ userpanelSettingKey[setting.dataSettingIndex] | language: settings.Lang }}</span>
                            <mat-slider color="primary" thumbLabel tickInterval="1" step="0.05"
                                [formControl]="setting.formControl" [min]="setting.min" [max]="setting.max"
                                (blur)="changeDetector.detectChanges()"
                                (change)="setting.onValueChanged && setting.onValueChanged(setting.dataSettingIndex)"
                                [matTooltipDisabled]="!setting.tooltipLangKey"
                                [matTooltip]="setting.tooltipLangKey | language: settings.Lang"></mat-slider>
                        </div>
                        <!-- <div *ngSwitchDefault>output2</div> -->
                    </ng-container>

                    <ng-container *ngSwitchCase="userpanelSettingType.enum">
                        <div class="setting-row">
                            <mat-form-field color="accent">
                                <mat-label>{{ userpanelSettingKey[setting.dataSettingIndex] | language: settings.Lang }}
                                </mat-label>
                                <mat-select [formControl]="setting.formControl" (blur)="changeDetector.detectChanges()"
                                    [matTooltipDisabled]="!setting.tooltipLangKey"
                                    [matTooltip]="setting.tooltipLangKey | language: settings.Lang"
                                    (change)="setting.onValueChanged && setting.onValueChanged(setting.dataSettingIndex)">
                                    <mat-option *ngFor="let enumStr of getEnumKeys(setting.enum)"
                                        [value]="setting.enum[enumStr]">
                                        {{ enumStr | language: settings.Lang }}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </ng-container>

                    <ng-container *ngSwitchCase="userpanelSettingType.dateTimeFormatEnum">
                        <div class="setting-row">
                            <mat-form-field color="accent">
                                <mat-label>{{ userpanelSettingKey[setting.dataSettingIndex] | language: settings.Lang }}
                                </mat-label>
                                <mat-select [formControl]="setting.formControl" (blur)="changeDetector.detectChanges()"
                                    [matTooltipDisabled]="!setting.tooltipLangKey"
                                    [matTooltip]="setting.tooltipLangKey | language: settings.Lang"
                                    (change)="setting.onValueChanged && setting.onValueChanged(setting.dataSettingIndex)">
                                    <mat-option *ngFor="let dateTimeFormat of getEnumKeys(setting.enum)"
                                        [value]="setting.enum[dateTimeFormat]">
                                        {{ currentDate | date:dateTimeFormat }}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </ng-container>

                    <ng-container *ngSwitchCase="userpanelSettingType.boolean">
                        <div class="setting-row">
                            <mat-checkbox labelPosition="before" [formControl]="setting.formControl"
                                (blur)="changeDetector.detectChanges()" [matTooltipDisabled]="!setting.tooltipLangKey"
                                [matTooltip]="setting.tooltipLangKey | language: settings.Lang"
                                (change)="setting.onValueChanged && setting.onValueChanged(setting.dataSettingIndex)">
                                {{ userpanelSettingKey[setting.dataSettingIndex] | language: settings.Lang }}
                            </mat-checkbox>
                        </div>
                    </ng-container>

                    <ng-container *ngSwitchCase="userpanelSettingType.booleanSlider">
                        <div class="setting-row">
                            <mat-slide-toggle labelPosition="before" [formControl]="setting.formControl"
                                [matTooltipDisabled]="!setting.tooltipLangKey"
                                [matTooltip]="setting.tooltipLangKey | language: settings.Lang"
                                (blur)="changeDetector.detectChanges()"
                                (change)="setting.onValueChanged && setting.onValueChanged(setting.dataSettingIndex)">
                                {{ userpanelSettingKey[setting.dataSettingIndex] | language: settings.Lang }}
                            </mat-slide-toggle>
                        </div>
                    </ng-container>

                    <ng-container *ngSwitchCase="userpanelSettingType.color">
                        <div class="setting-row">
                            <mat-form-field color="accent">
                                <mat-label>{{ userpanelSettingKey[setting.dataSettingIndex] | language: settings.Lang }}</mat-label>
                                <input #input matInput [(colorPicker)]="setting.formControl.value"
                                    [formControl]="setting.formControl"
                                    [style.background]="setting.formControl.value" [cpFallbackColor]="setting.defaultValue"
                                    (colorPickerChange)="onColorChange(setting)" cpOutputFormat="rgba"
                                    cpAlphaChannel="always" cpUseRootViewContainer="true"
                                    [cpIgnoredElements]="[input]"
                                    [(cpToggle)]="setting.toggleColorPicker"
                                    [matTooltipDisabled]="!setting.tooltipLangKey"
                                    [matTooltip]="setting.tooltipLangKey | language: settings.Lang"
                                    (change)="setting.onValueChanged && setting.onValueChanged(setting.dataSettingIndex)" />
                            </mat-form-field>
                            <button mat-icon-button (click)="setting.toggleColorPicker = !setting.toggleColorPicker">
                                <mat-icon color="accent">color_lens</mat-icon>
                            </button>
                            <button *ngIf="setting.nullable" mat-icon-button (click)="setting.formControl.value = undefined">
                                <mat-icon color="accent">delete_outline</mat-icon>
                            </button>
                        </div>
                    </ng-container>
                </ng-container>
            </mat-expansion-panel>
        </mat-accordion>
    </div>

    <div id="last-row-buttons">
        <button mat-raised-button (click)="save()">
            {{ 'Save' | language: settings.Lang }}
        </button>
        <button mat-raised-button (click)="revertAll()">
            {{ 'Revert' | language: settings.Lang }}
        </button>
        <button mat-raised-button (click)="setDefault()">
            {{ 'Default' | language: settings.Lang }}
        </button>
    </div>
</div>
